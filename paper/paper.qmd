---
title: "Perceptions of Corruption in Nigeria"
subtitle: "Rural Nigerians and Less Educated  Groups Report Higher Corruption"
author: 
  - Fatimah Yunusa
thanks: "Code and data are available at:https://github.com/fatimahsy/Nigeria_Democracy-"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
editor: 
  markdown: 
    wrap: 72
---

```{r}
#| include: false
#| warning: false
#| message: false
#| label: setup

#install.packages("modelsummary")
#install.packages("rstanarm")
#install.packages("dplyr")
#install.packages("here")
#install.packages("arrow")
#install.packages(tinytable)
library(modelsummary)
library(rstanarm)
library(dplyr)
library(here)
library(arrow)
library(bayesplot)
library(ggplot2)
library(arrow)
library(here)
library(patchwork)

# Load data
cleaned_data <- read_parquet(here::here("data/02-analysis_data/cleaned_nigeriasurvey.parquet"))
bayesian_model <- readRDS(file = here::here ("models/bayesian_model.rds"))
```

# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as
follows. @sec-data....

# Data {#sec-data}

## Measurement

For this analysis, i use the Afrobarometer Round 9, Nigeria, 2023
survey. Afrobarometer conducts surveys that are nationally
representative across African nations to capture public perceptions on
topics like governance, democracy, and economic issues. The Nigerian
Round 9 survey dataset contains responses from 1,556 people and shows the diverse demographic statistics across gender, region,
and residence type(urban or rural). The data is freely available on the
Afrobarometer website[@afrobarometer2023] and was collected through a
multi-stage, stratified sampling method. This is to ensure
representativeness and enables analysis of different demographics and
socioeconomic indicators.

Our primary measurement task is to capture public opinion towards
economic, political and socioeconomic issues and translate it into
actionable lintel. The Afrobarometer survey translates these real world
perceptions into quantifiable data using survey instruments.The process
begins with identifying relevant phenomena in the Nigerian
socio-political and economic context, such as public attitudes toward
democracy, demand for governance accountability, and perceived economic
conditions. These phenomena are operationalized into survey questions
that are clear, culturally sensitive, and tailored to elicit meaningful
responses.

For example:

-   Perceptions of Democracy: A phenomenon such as the demand for
    democracy is operationalized by questions asking respondents whether
    they prefer democracy over other forms of governance, and whether
    they believe Nigeria is a democratic nation. These questions are
    grounded in observable public discourse, historical trends, and
    policy outcomes.
-   Economic Prosperity: Attitudes toward economic conditions are
    measured by asking individuals to rate the current state of the
    economy and their own living standards. These subjective evaluations
    stem from tangible experiences like inflation, unemployment, or
    changes in public service delivery.

Each survey question acts as a data proxy for these complex real-world
dynamics, reducing them to quantifiable variables while maintaining
their conceptual integrity.

This dataset captures a unique moment in Nigeria's socio-political
landscape, reflecting how citizens perceive democracy and governance in
the context of ongoing economic and political challenges. Alternative
datasets, such as Nigeria’s national statistics or World Bank survey
data, could provide economic indicators but lack the granularity of
Afrobarometer’s public opinion data.

The data for this study was downloaded, cleaned, analyzed, modeled, and visualized using R [@citeR], a statistical programming language. The following packages were used:

- **`modelsummary`** [@modelsummary]: Used to create well-formatted regression tables and summaries.
- **`rstanarm`** [@rstanarm]: Facilitated Bayesian regression modeling using the Stan backend.
- **`dplyr`** [@dplyr]: Streamlined data manipulation, transformation, and summarization processes.
- **`here`** [@here]: Simplified the organization of file paths, improving project reproducibility.
- **`arrow`** [@arrow]: Enabled efficient handling of large datasets with fast reading and writing capabilities.
- **`bayesplot`** [@bayesplot]: Assisted in producing diagnostic checks and posterior predictive visualizations for Bayesian models.
- **`ggplot2`** [@ggplot2]: Provided extensive tools for creating clear and impactful visualizations.
- **`patchwork`** [@patchwork]: Combined multiple plots into cohesive, professional visuals.
- **`knitr`** [@knitr]: Enabled dynamic report generation, integrating code, output, and text seamlessly.
- **`kableExtra`** [@kableExtra]: Enhanced table styling and formatting for clean, professional presentations.
- **`ggalt`** [@ggalt]: Allowed the creation of specialized plots, enhancing the depth of data visualizations.
- **`haven`** [@haven]: Facilitated the import of `.sav` survey data from the Afrobarometer.
- **`broom.mixed`** [@broommixed]: Streamlined the extraction and tidying of results from mixed models for easy analysis and visualization.
- **`afrobarometer`** [@afrobarometer2023]: Served as the primary data source, providing valuable survey data for analysis.
- **_Telling Stories with Data_** [@tellingstories]: This book was referenced for its code and methodologies. 


## Cleaned Data Overview 
```{r}
#| label: tbl-cleaned-data-preview
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Preview of the Cleaned Dataset"

#install.packages("knitr")
#install.packages("kableExtra")
library(knitr)
library(kableExtra)

# Create a preview of the cleaned dataset
table_preview <- cleaned_data %>% 
  select(-c(1:6)) %>%
  head(6)

# Generate a well-formatted table using kableExtra
kable(
  table_preview, 
  caption = "Preview of the Cleaned Dataset"
) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)
```

@tbl-cleaned-data-preview represents the first six cleaned rows of the
dataset, showing the important variables used in the analysis. The
variables were constructed from specific survey questions in the
Afrobarometer Round 9 Nigeria Survey [@afrobarometer2023], which
captures several socioeconomic sentiments within the country.The column
corruption_presidency captures perceptions of corruption within the
office of the presidency, derived from responses to the question, “How
many of the following people do you think are involved in corruption, or
haven’t you heard enough about them to say: the president and officials
in his office?” The variable education reflects respondents' highest
level of education completed, gathered from the question, “What is the
highest level of education you have completed?” The gender variable
indicates the respondent's gender, collected through direct demographic
inquiry. The column age_group categorizes respondents into age brackets
based on the question, “How old are you?” The urban_rural variable
distinguishes between urban and rural respondents, as recorded by
interviewers based on the primary sampling unit (PSU) during data
collection [@survey_manual_2022]. Lastly, region specifies the
geographical region of each respondent, identified using a unique code
for Nigerian states. This table not only demonstrates the diversity of
the dataset but also highlights the breadth of demographic and
governance-related variables included for analysis.

```{r}
#| label: tbl-summary-statistics
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| tbl-cap: "Detailed Summary Statistics of the Cleaned Dataset"

library(dplyr)
library(knitr)
library(kableExtra)


# Ensure the age_group column is a character for correct mapping
cleaned_data <- cleaned_data %>%
  mutate(age_group = as.character(age_group))

# Function to calculate the mode (most frequent category)
calculate_mode <- function(x) {
  x <- na.omit(x)
  unique_x <- unique(x)
  unique_x[which.max(tabulate(match(x, unique_x)))]
}


# Adjust line breaks for proper rendering
line_break <- ifelse(knitr::is_html_output(), "<br>", "\n")

# Prepare the data for the transposed table
transposed_summary <- tibble(
  Statistic = c(
    "Most Frequent Age Group", 
    "Urban Percentage", 
    "Male Percentage", 
    "Corruption Counts", 
    "Education Counts"
  ),
  Value = c(
    calculate_mode(cleaned_data$age_group), 
    paste0(round(mean(cleaned_data$urban_rural == "Urban Residents", na.rm = TRUE) * 100, 2), "%"),
    paste0(round(mean(cleaned_data$gender == "Male", na.rm = TRUE) * 100, 2), "%"),
    paste0(
      "None: 61", line_break,
      "Some: 574", line_break,
      "High: 593", line_break,
      "All: 328"
    ),
    paste0(
      "Primary: 203", line_break,
      "Secondary: 173", line_break,
      "University: 102", line_break,
      "Postgraduate: 07"
    )
  )
)

# Generate a formatted table
kable(
  transposed_summary, 
  col.names = c("Statistic", "Value"),
  caption = "Detailed Summary Statistics of the Cleaned Dataset (Transposed)",
  escape = FALSE # Disables escaping for proper HTML/PDF formatting
) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE) %>%
  column_spec(2, width = "20em") # Adjust width for better multiline display

```
The cleaned dataset used in this study is summarised in @tbl-summary-statistics, which provides key statistics to offer an overview of the dataset's structure and characteristics. The most frequent age group among respondents is identified, representing the predominant demographic in terms of age. The table also highlights the urban and male percentages, which indicate the proportion of urban residents (43.38%) and male respondents (49.68%) in the sample.

Further, the table breaks down the perceptions of corruption into four categories—"None," "Some," "High," and "All"—with counts for each, offering insights into respondents' views on corruption in the presidency. Additionally, the table details the distribution of respondents across education levels, including categories such as "Primary," "Secondary," "University," and "Postgraduate." Together, these summary statistics provide a comprehensive snapshot of the dataset, enabling a clear understanding of its demographic and categorical variables.  



## Variables of Interest
```{r}
#| label: fig-urban-rural-distribution
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: " Urban vs Rural Respondent Distribution. This bar chart compares the number of respondents residing in urban versus rural areas in Nigeria."

# Plot: Urban vs Rural Respondent Distribution
cleaned_data %>%
  count(URBRUR) %>%
  ggplot(aes(x = URBRUR, y = n, fill = URBRUR)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Urban vs Rural Respondent Distribution",
    x = "Respondent Location",
    y = "Number of Respondents"
  ) +
  theme_minimal() +
  scale_fill_manual(
    values = c("Urban Residents" = "blue", "Rural Residents" = "gray")
  ) +
  guides(fill = "none")

```

@fig-urban-rural-distribution illustrates the distribution of survey
respondents based on their residential location, categorized as urban or
rural. From this, we see that the sample has more rural residents
compared to urban residents. Specifically, the Afrobarometer survey for
Nigeria, conducted in 2022, reports that approximately 53% of Nigeria's
population resides in rural areas, this is is consistent with national
demographic trends [@worldbank2022rural]. This rural-urban distribution
is important for helping us understand the perspectives seen in the
survey, since rural populations may have different challenges in
governance and corruption compared to urban populations. The imbalance
in representation shows that looking at geographical disparities when
interpreting results from nationwide surveys is important.

```{r}
#| label: fig-corruption-presidency
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Perceived Corruption in the Presidency. This bar chart shows the distribution of respondents' perceptions of corruption in the presidency in Nigeria."

# Plot: Perceived Corruption in the Presidency
cleaned_data %>%
  count(corruption_presidency) %>%
  ggplot(aes(x = corruption_presidency, y = n, fill = corruption_presidency)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Perceived Corruption in the Presidency",
    x = "Perception of Corruption",
    y = "Number of Respondents"
  ) +
  theme_minimal() +
  scale_fill_manual(
    values = c("No Corruption" = "green", 
               "Some Corruption" = "yellow", 
               "High Corruption" = "red", 
               "All Corrupt" = "purple")
  ) +
  guides(fill = "none")

```

 @fig-corruption-presidency presents the distribution of respondents'
perceptions of corruption within the Nigerian presidency. The variable
"Perceived Corruption in the Presidency" captures respondents'
perceptions of the extent of corruption within the Nigerian presidency
and its officials. This variable originates from Question 38A of the
Afrobarometer survey, which asked: *"How many of the following people do
you think are involved in corruption, or haven’t you heard enough about
them to say: the president and officials in his office?"*
[@Afrobarometer2022codebook] Respondents could choose from the following
values:

-   **0 (None)**: Indicates that the respondent perceives no corruption
    in the office of the presidency.
-   **1 (Some of them)**: Suggests that the respondent believes a few
    individuals in the presidency are involved in corruption.
-   **2 (Most of them)**: Reflects the perception that corruption is
    prevalent among the majority of the presidency's officials.
-   **3 (All of them)**: Suggests the respondent perceives widespread
    corruption, implicating all officials in the presidency.
-   **8 (Refused)**: Indicates the respondent declined to answer the
    question.
-   **9 (Don’t know/Haven’t heard enough)**: Suggests the respondent was
    unsure or lacked sufficient knowledge to provide an answer.
-   **-1 (Missing)**: Represents missing or unavailable responses.

For the analysis, only the substantive responses (0-3) were considered,
in order to help us look into perceptions of corruption within the
presidency. The high frequency of responses in the "High Corruption" and
"Some Corruption" categories reflects persistent concerns about the
integrity of key officials in Nigeria, aligning with broader findings on
corruption in the region. @fig-corruption-presidency presents the
distribution of respondents' perceptions of corruption within the
Nigerian presidency. Among these, the category "High corruption" is the
most frequently reported, followed by "Some corruption". "All corrupt"
ranks third, with "No Corruption" being the least chosen category which
is no surprise given our data is in the context of Nigeria. These
proportions show significant public concern about corruption within the
presidency, consistent with broader trends in public concern abut
corruption corruption within the presidency in Nigeria.

```{r}
#| label: fig-dumbbell-education
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Distribution of Education Levels in Nigeria"
#install.packages("ggalt")
library(ggalt)

cleaned_data %>%
  count(education) %>%
  ggplot(aes(x = n, y = reorder(education, n))) +
  geom_dumbbell(
    aes(xend = 0, x = n), 
    size = 3, colour = "darkblue", dot_guide = TRUE
  ) +
  theme_minimal() +
  labs(
    title = "Distribution of Education Levels in Nigeria",
    x = "Number of Respondents", y = "Education Level"
  )



```

@fig-dumbbell-education visually represents the educational attainment
levels of respondents in the Afrobarometer survey for Nigeria. The data
reflects responses to the question: *What is your highest level of
education?*. The chart indicates that the most frequent reported level
of education is "secondary school completed," followed by "primary
school completed" and "no formal schooling". Fewer respondents reported
having attained "post secondary qualifications," "university completed,"
or "Post-graduate" education, shows the disparity in advanced
educational attainment across the population. This distribution shows
that basic education levels are more prevalent among respondents, which
may influence their perceptions and responses in the broader survey.
Including educational attainment is important in our analysis because it
is an important socioeconomic factor.

```{r}
#| label: fig-age-group-distribution
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Age Group Distribution. This bar chart displays the number of respondents in each age group in Nigeria."

# Plot: Age Group Distribution
cleaned_data %>%
  count(age_group) %>%
  ggplot(aes(x = age_group, y = n, fill = age_group)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Age Group Distribution",
    x = "Age Group",
    y = "Number of Respondents"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set3") +
  guides(fill = "none")



```

@fig-age-group-distribution illustrates the distribution of survey
respondents across five distinct age groups: 18-24, 25-34, 35-44, 45-54,
and 55+. The data reveals that the 25-34 age group is the most
represented, with over 500 respondents, followed by the 35-44 age group.
The youngest cohort, aged 18-24, comprises approximately 300
respondents, while the older age groups (45-54 and 55+) are less
represented in the dataset, with fewer than 200 respondents each. This
distribution highlights a concentration of responses from younger
demographics, particularly those aged 25-34, which may reflect broader
societal trends such as population age structure or survey reach and
accessibility.

## Combined variables of interest? 

```{r}
#| label: fig-variables-of-interest
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "combined variables of interest"

library(patchwork)

# Create individual plots
urban_plot <- cleaned_data %>%
  count(URBRUR) %>%
  ggplot(aes(x = URBRUR, y = n, fill = URBRUR)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Urban vs Rural", x = "Location", y = "Count")

corruption_plot <- cleaned_data %>%
  count(corruption_presidency) %>%
  ggplot(aes(x = corruption_presidency, y = n, fill = corruption_presidency)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Corruption Perception", x = "Perception", y = "Count")

education_plot <- cleaned_data %>%
  count(education) %>%
  ggplot(aes(x = n, y = reorder(education, n))) +
  geom_col(fill = "darkblue") +
  theme_minimal() +
  labs(title = "Education Level", x = "Count", y = "Education")

age_plot <- cleaned_data %>%
  count(age_group) %>%
  ggplot(aes(x = age_group, y = n, fill = age_group)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Age Distribution", x = "Age Group", y = "Count")

# Combine plots
urban_plot + corruption_plot + education_plot + age_plot +
  plot_layout(ncol = 2)

```



```{r}
#| label: fig-variables-of-interest-heatmap
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "combined variables of interest"

#install.packages("tidyr")
library(tidyr)
# Combine data for heatmap
heatmap_data <- cleaned_data %>%
  pivot_longer(
    cols = c(URBRUR, corruption_presidency, education, age_group),
    names_to = "variable",
    values_to = "category"
  ) %>%
  count(variable, category) %>%
  mutate(variable = factor(variable, levels = c("URBRUR", "corruption_presidency", "education", "age_group")))

# Create heatmap
ggplot(heatmap_data, aes(x = category, y = variable, fill = n)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Heatmap of Variable Distributions",
    x = "Category",
    y = "Variable",
    fill = "Count"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  )


```

## Corruption Perceptions Vs Variables of Interest 
```{r}
#| label: fig-education-vs-corruption
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Relationship between Education Levels and corruption percetpions in Nigeria  in Nigeria"


cleaned_data %>%
  count(education, corruption_presidency) %>%
  ggplot(aes(x = corruption_presidency, y = education, fill = n)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(
    title = "Heatmap of Education and Corruption Perceptions",
    x = "Corruption Perception",
    y = "Education Level",
    fill = "Number of Respondents"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12, hjust = 0.5), # Reduce title size and center it
    axis.text.x = element_text(angle = 45, hjust = 1), # Rotate x-axis labels
    axis.text.y = element_text(size = 10) # Adjust y-axis label size
  )



```

This heatmap in @fig-education-vs-corruption shows the relationship between respondents’ education levels and their perceptions of corruption in Nigeria. The x-axis represents corruption perception categories (All Corrupt, High Corruption, No Corruption, and Some Corruption), while the y-axis represents education levels, ranging from No Formal Schooling to Post-graduate. The intensity of the color reflects the number of respondents, with darker shades indicating higher counts.

The heatmap reveals that respondents who completed secondary school or some secondary schooling dominate the High Corruption and Some Corruption categories. Respondents with higher education levels (university and post-graduate) are distributed more evenly across the corruption perception categories, with fewer concentrated in any specific category. Conversely, respondents with no formal schooling or only informal education are sparsely represented across all categories.

This visualization highlights a notable concentration of corruption perceptions among respondents with mid-level education (secondary schooling), while those with higher education tend to have more varied perceptions. These findings suggest a potential link between educational attainment and experiences or attitudes toward corruption, particularly among those with secondary-level education.

```{r}
#| label: fig-age-versus-corruption
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Age Group Vs. Corruption Perception. This faceted bar chart plots the relationship between the age group of respondents and their different corruption perception levels in Nigeria."


# Create the faceted bar chart
ggplot(cleaned_data, aes(x = age_group, fill = age_group)) +
  geom_bar() +
  facet_wrap(~corruption_presidency) +
  labs(
    title = "Corruption Perceptions across Age Groups",
    x = "Age Group",
    y = "Count of Respondents",
    fill = "Age Group"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set3") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5)
  )

```
@fig-age-versus-corruption shows the relationship between respondents' age group and their perceptions of corruption in Nigeria. Each panel corresponds to one of four corruption perception levels: * All Corruption, High Corruption, Some Corruption, and No Corruption.*Whitin each panel, the bars represent the count of respondent across five age groups (18-24, 25-34, 35-44, 45-54, and 55+), enabling a clear comparison of how perceptions vary by age. 

The 25–34 and 35–44 age groups have the highest counts in the High Corruption and Some Corruption categories, suggesting that middle-aged respondents are more likely to perceive corruption as significant. In contrast, younger respondents (18–24) and older respondents (55+) report lower levels of corruption perception in these categories.

In the All Corrupt category, the 25–34, 35–44, and 55+ age groups dominate, while the 18–24 and 45–54 groups have lower counts. The No Corruption category has low counts across all age groups, indicating that very few respondents, regardless of age, perceive the absence of corruption.

These results indicate that middle-aged respondents (25–44) are the most likely to report high levels of corruption perception, while younger and older groups report less. The consistently low counts in the No Corruption category reflect a widespread belief that corruption is a persistent issue in Nigeria.

```{r}
#| label: fig-ruralurban-versus-corruption
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Rural/Urban Vs. Corruption Perception. This stacked bar chart visualises the relationship between respondents' corruption perceptions and weather they live in rural or urban areas in Nigeria."

# Summarize the data
corruption_vs_urban <- cleaned_data %>%
  count(urban_rural, corruption_presidency) %>%
  group_by(urban_rural) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()

# Create the stacked bar chart
ggplot(corruption_vs_urban, aes(x = urban_rural, y = proportion, fill = corruption_presidency)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(
    title = "Relationship between Rural vs. Urban Respondents and Corruption Perceptions",
    x = "Respondent Location",
    y = "Proportion of Respondents",
    fill = "Corruption Perception"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5)
  )


# Convert corruption_presidency to numeric if needed
cleaned_data$corruption_numeric <- as.numeric(factor(cleaned_data$corruption_presidency))



```
The relationship between respondents' residential location (rural vs. urban) and their perceptions of corruption is shown in @fig-ruralurban-versus-corruption Each bar represents the proportion of respondents within rural and urban groups who hold different corruption perceptions: All Corrupt, High Corruption, Some Corruption, and No Corruption.

The chart reveals that rural and urban respondents share similar patterns of corruption perception. The majority of respondents in both groups fall under the Some Corruption and High Corruption categories, with Some Corruption being slightly more prevalent. The All Corrupt category is the third most common perception in both groups, while the No Corruption category is consistently the least represented.

These findings indicate that residential location does not significantly influence corruption perceptions, as rural and urban respondents report similar distribution patterns across all categories. The results suggest that perceptions of corruption are pervasive and relatively consistent across geographic locations.

```{r}
#| label: fig-gender-versus-corruption
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| fig.cap: "Gender Vs corruption perceptions. This faceted bar chart shows the relationship between a respondents' gender and how they perceive corruption within the presidency in Nigeria."

# Summarize the data
corruption_vs_gender <- cleaned_data %>%
  count(gender, corruption_presidency) %>%
  group_by(gender) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()

# Create the faceted bar chart
ggplot(cleaned_data, aes(x = corruption_presidency, fill = corruption_presidency)) +
  geom_bar() +
  facet_wrap(~gender) +
  labs(
    title = "Corruption Perceptions by Gender",
    x = "Corruption Perception",
    y = "Count of Respondents",
    fill = "Corruption Perception"
  ) +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )



```
@fig-gender-versus-corruption shows the the relationship between respondents' gender (male and female) and their perceptions of corruption. Each panel represents one gender, displaying the count of respondents across four corruption perception categories: All Corrupt, High Corruption, Some Corruption, and No Corruption.

The chart shows that both male and female respondents share similar patterns of corruption perception. The High Corruption and Some Corruption categories have the highest counts for both genders, indicating these are the most commonly held views. The All Corrupt category has fewer respondents, while the No Corruption category consistently has the lowest counts for both genders.

These results suggest that gender does not significantly influence perceptions of corruption, as male and female respondents exhibit similar distribution patterns across all perception categories. The findings highlight a shared acknowledgment of corruption as a major issue across genders in Nigeria.

# Model {#sec-model}

## Model set-up

A Bayesian ordinal logistic regression model is used to estimate the
relationship between various demographic factors and perceptions of
corruption in the presidency. Ordinal logistic regression is a
statistical technique used for ordered categorical outcomes to predict
the cumulative probability of being in a particular category or below,
given a set of predictor variables.

My model includes four independent demographic variables: `education`,
`gender`, `urban_rural`, and `age_group`. The dependent variable is
`corruption_presidency`, which has four ordered categories: "None,"
"Some," "Most," and "All."

The ordinal logistic regression model I used is: \begin{equation}
\log\left(\frac{P(y_i \leq j)}{P(y_i > j)}\right) = \alpha_j - \left(\beta_1 \times \text{education} + \beta_2 \times \text{gender} + \beta_3 \times \text{urban rural} + \beta_4 \times \text{age group}\right)
\end{equation}

$$
\begin{aligned}
\beta_1 & \sim \mbox{Normal}(0, 2.5)\\
\beta_2 & \sim \mbox{Normal}(0, 2.5)\\
\beta_3 & \sim \mbox{Normal}(0, 2.5)\\
\beta_4 & \sim \mbox{Normal}(0, 2.5)\\
\alpha_j & \sim \mbox{Normal}(0, 2.5) \quad \text{for } j = 1, 2, 3\\
\pi_{ij} & \sim \mbox{Dirichlet}(\alpha = 1)
\end{aligned}
$$ where:

-   $y_i$ represents the ordinal outcome for respondent $i$, indicating
    their perception of corruption in the presidency.

-   $P(y_i \leq j)$ is the cumulative probability of respondent $i$
    falling into category $j$ or below.

-   $\alpha_j$ are the threshold parameters that define the boundaries
    between the corruption categories.

-   $\beta_1, \beta_2, \beta_3, \beta_4$ are the coefficients
    corresponding to the predictors:

    -   $\beta_1$: Education level of the respondent.
    -   $\beta_2$: Gender of the respondent (male or female).
    -   $\beta_3$: Urban or rural location of the respondent.
    -   $\beta_4$: Age group of the respondent.

-   $\pi_{ij}$ is the probability that respondent $i$ falls into
    corruption category $j$.

In this model, the priors reflect a belief that the predictors explain
about 20% of the variability in the outcome, as defined by the
$R^2(0.2)$ prior. The Normal priors with a mean of 0 and standard
deviation of 2.5 for the coefficients and threshold parameters are
relatively weakly informative, ensuring the data have a significant role
in determining the posterior distributions.

The threshold parameters ($\alpha_j$) separate the ordered categories of
the outcome variable, while the Dirichlet prior for $\pi_{ij}$ assumes
no strong prior preference for any specific corruption category.

The use of these priors provides flexibility for the model while
preventing overfitting. The posterior distributions for the coefficients
and thresholds, along with diagnostic checks for model convergence and
predictive accuracy, can be found in the Appendix.

### Model Assumptions

The model relies on the following assumptions:

-   Proportional Odds: The relationship between the predictors and the
    log-odds of being in a higher corruption category is constant across
    thresholds.
-   Ordinal Outcomes: The response categories are ordered, but the
    distances between them are not quantitatively defined.
-   Independence of observations: Responses from different individuals
    are assumed to be independent.

## Model Justification

The Bayesian approach was chosen because of its flexibility in
incorporating prior beliefs and its ability to provide real
quantification for uncertainty for parameter estimates. An ordinal
logistic regression model is appropriate because the outcome variable
(perceived corruption) is inherently ordered.

The predictors-education, gender, urban/rural location, and age group-
were selected based on their theoretical relevance to perceptions of
governmental corruption in Nigeria, as discussed in the data section.
For example, urban and rural individuals may influence exposure to
governance systems, while education might shape perceptions of systemic
corruption.

The modeling decisions align closely with the structure and
characteristics of the dataset to ensure interpretability and relevance.
Age was included as a categorical variable reflecting predefined groups,
allowing the model to capture non-linear relationships between age and
perceptions of corruption. Education was treated as a categorical
variable to account for differences across distinct milestones, such as
"Primary school completed" and "Post-graduate qualifications." Gender
was modeled as a binary variable ("Male" or "Female") to reflect
societal influences on corruption perceptions. Urban versus rural
context was included as a binary variable to capture potential
differences in exposure to governance and information access. While the
dataset includes regional information, province effects were excluded to
maintain focus on demographic factors and simplify the model. Finally,
the ordinal logistic regression framework was chosen to respect the
ordered nature of the outcome variable ("None," "Some," "Most," "All")
without assuming equal distances between categories. These decisions
ensure the model is both consistent with the data and well-suited to
addressing the research question.

# Results

## Corruption Perceptions Model

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Summary of the Ordinal Logistic regression model"
#| warning: false

#install.packages("broom.mixed")
#install.packages("kableExtra")

library(broom.mixed)
library(kableExtra)

# Extract summary
model_summary <- broom.mixed::tidy(bayesian_model)

# Render as a table
knitr::kable(
  model_summary,
  caption = "Summary of the Bayesian Model",
  digits = 2
) %>%
  kableExtra::kable_styling()



```

The analysis revealed distinct trends in Corruption perceptions in
different demographics. Our results are summarized in @tbl-modelresults.This presents the estimated coefficients and standard
errors for each predictor included in the model. The dependent variable
is the perception of corruption in the presidency, categorized into
ordered levels. The table includes predictors such as education level,
gender, urban or rural location, and agre group, which are modeled to
explain variations in corruption perceptions. Each predictor's
coefficient represents its effect on the log odds of perceiving
corruption in the presidency at a specific level relative to lower
levels, holding other variables constant.

Higher education levels(e.g., university or post-graduate
qualifications) arre associated with positive effects on corruption
perceptions, indicating a greater likelihood of perceived higher levels
of corruption. Begin female shows a small positive association with
higher corruption perceptions. Residing in rural areas is negatively
associated with corruption perceptions, suggesting lower perceptions of
corruption compared to urban counterparts. Agegroups show minimal
variation in their association with corruption perceptions, with no
significant deviations observed among different age brackets.

## Predicted Probabilities

```{r}
#| echo: false
#| eval: true
#| label: fig-predicted-probabilities
#| fig-cap: "Predicted probabilities of high corruption perceptions by key predictors."

library(ggplot2)

# Simulating or using your posterior data
predicted_data <- data.frame(
  Predictor = names(coef(bayesian_model)),
  Estimate = coef(bayesian_model)
)

# Plot with adjusted x-axis labels
ggplot(predicted_data, aes(x = Predictor, y = Estimate)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),  # Rotate and reduce size
    axis.title.x = element_text(size = 10)
  ) +
  labs(
    title = "Predicted Probabilities by Demographics",
    x = "Predictor",
    y = "Probability"
  )

```

@fig-predicted-probabilities illustrates the predicted probabilities
derived from the Bayesian ordinal logistic regression model for
different demographic predictors influencing corruption perceptions in
Nigeria. Each bar represents the estimated impact of a specific
predictor on the likelihood of perceiving higher corruption levels in
the presidency.

Higher education levels consistently show positive probabilities,
indicating that individuals with more advanced education levels are more
likely to perceive higher corruption levels. Living in rural areas has a
significantly negative probability, suggesting that rural residents are
less likely to perceive high corruption compared to urban residents.
Gender shows a moderate positive probability, with females slightly more
likely to perceive higher corruption levels than males. There seems to
be minimal variation observed across age groups, suggesting that age
does not substantially influence perceptions of corruption.

The results show that higher levels of education, particularly
university completion and post-secondary qualifications, are associated
with greater perceptions of corruption in the presidency. Urban
residents demonstrate significantly higher perceived corruption levels
compared to rural residents. Gender differences reveal that female
respondents show slightly higher corruption perceptions, while age
groups show minimal variation. These findings are shown in the
regression estimates and predicted probabilities, as visualized in
@fig-predicted-probabilities and summarized in @tbl-modelresults.


# Discussion

This paper looks into public perceptions of corruption within the Nigerian Presidency, using data from Afrobarometer Round 9 survey. A bayesian ordinal logistic regression model was used to evaluate the influence of demographic variables like education, gender, urban/rural residence, and age group on corruption perceptions. We found that higher education levels, urban residency, and gender play significant roles in shaping perceptions, with educated and urban individuals more likely to perceive high levels of corruption in Nigeria. 

## The Role of Education in Shaping Corruption Perceptions {#sec-first-point}


## Urban-Rural Disparities in Perception



## Gender Dynamics in Corruption Perception 

## Policy Implications 


## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {.unnumbered}

# Additional data details

# Model details {#sec-model-details}

## Posterior Predictive Check

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheck
#| fig-cap: "Posterior Predictive Check for the Bayesian ordinal logistic regression model."

# Load the Bayesian model
bayesian_model <- readRDS(file = here::here("models/bayesian_model.rds"))

# Posterior Predictive Check
pp_check(bayesian_model) +
  theme_classic() +
  labs(
    title = "Posterior Predictive Check",
    x = "Observed Data",
    y = "Density"
  )

```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-posteriorvsprior-education
#| fig-cap: "Posterior vs Prior Comparison for Education Parameters."

# Education Parameters
education_params <- c(
  "educationInformal schooling only",
  "educationSome primary schooling",
  "educationPrimary school completed",
  "educationSome secondary schooling",
  "educationSecondary school completed",
  "educationPost-secondary qualifications",
  "educationSome university",
  "educationUniversity completed",
  "educationPost-graduate"
)

posterior_vs_prior(bayesian_model, pars = education_params, group_by_parameter = TRUE) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) +
  labs(
    title = "Posterior vs Prior Comparison (Education Parameters)",
    x = "Parameter Value",
    y = "Density",
    color = "Distribution"
  )


```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-posteriorvsprior-demographic
#| fig-cap: "Posterior vs Prior Comparison for Demographic Parameters."

# Demographic Parameters
demographic_params <- c(
  "genderFemale",
  "urban_ruralRural",
  "age_group25-34",
  "age_group35-44",
  "age_group45-54",
  "age_group55+"
)

posterior_vs_prior(bayesian_model, pars = demographic_params, group_by_parameter = TRUE) +
  theme_minimal() +
  scale_color_brewer(palette = "Set2") +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  ) +
  labs(
    title = "Posterior vs Prior Comparison (Demographic Parameters)",
    x = "Parameter Value",
    y = "Density",
    color = "Distribution"
  )

```

## Diagnostics

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-diagnostic-ppcheck
#| fig-cap: "Posterior Predictive Check for the Bayesian ordinal logistic regression model."

# Posterior Predictive Check
pp_check(bayesian_model) +
  theme_classic() +
  labs(
    title = "Posterior Predictive Check",
    x = "Observed Data",
    y = "Density"
  )

```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-diagnostic-traceplot
#| fig-cap: "Trace plot for selected parameters in the Bayesian ordinal logistic regression model."

# Trace Plot
mcmc_trace(as.array(bayesian_model), pars = c("educationSome primary schooling", "urban_ruralRural")) +
  theme_minimal() +
  labs(
    title = "Trace Plot for Selected Parameters",
    x = "Iteration",
    y = "Parameter Value"
  )

```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-diagnostic-rhat
#| fig-cap: "Rhat values for model convergence in the Bayesian ordinal logistic regression model."

# Rhat Plot
mcmc_rhat(rhat(bayesian_model)) +
  theme_minimal() +
  labs(
    title = "Rhat Plot",
    x = "Rhat Values",
    y = "Parameters"
  )

```

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-diagnostic-ess
#| fig-cap: "Effective sample size plot for parameters in the Bayesian ordinal logistic regression model."

# Effective Sample Size Plot
mcmc_neff(neff_ratio(bayesian_model)) +
  theme_minimal() +
  labs(
    title = "Effective Sample Size Plot",
    x = "Effective Sample Size Ratio",
    y = "Parameters"
  )

```

\newpage

# References
